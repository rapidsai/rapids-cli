[project]
name = "rapids-cli"
description = "A CLI for RAPIDS"
dynamic = ["version"]
license = "Apache-2.0"
license-files = ["LICENSE"]
requires-python = ">=3.10"
dependencies = [
    "importlib-metadata >= 4.13.0; python_version < '3.12'",
    "nvidia-ml-py>=12.0",
    "packaging",
    "psutil",
    "rich",
    "rich-click",
] # This list was generated by `rapids-dependency-file-generator`. To make changes, edit dependencies.yaml and run `rapids-dependency-file-generator`.

[project.optional-dependencies]
test = [
    "pytest",
] # This list was generated by `rapids-dependency-file-generator`. To make changes, edit dependencies.yaml and run `rapids-dependency-file-generator`.

[project.scripts]
rapids = "rapids_cli.cli:rapids"

[project.entry-points.rapids_doctor_check]
gpu = "rapids_cli.doctor.checks.gpu:gpu_check"
gpu_compute_capability = "rapids_cli.doctor.checks.gpu:check_gpu_compute_capability"
cuda = "rapids_cli.doctor.checks.cuda_driver:cuda_check"
memory_to_gpu_ratio = "rapids_cli.doctor.checks.memory:check_memory_to_gpu_ratio"
nvlink_status = "rapids_cli.doctor.checks.nvlink:check_nvlink_status"

[project.urls]
Homepage = "https://github.com/rapidsai/rapids-cli"
Source = "https://github.com/rapidsai/rapids-cli"

[build-system]
requires = ["hatchling", "hatch-vcs"]
build-backend = "hatchling.build"

[tool.hatch.build.hooks.vcs]
version-file = "rapids_cli/_version.py"

[tool.hatch.version]
source = "vcs"

[tool.setuptools.packages.find]
include = [
    "rapids_cli*",
    "rapids_cli.*",
]

[tool.black]
# this should match the oldest version of Python the library supports
target-version = ["py310"]

[tool.codespell]
# NOTE: pre-commit passes explicit lists of files here, which this skip file list doesn't override.
#       This is just here for IDEs.
skip = "./.git,./pyproject.toml,./.ruff_cache"
quiet-level = 3

[tool.pytest]
testpaths = ["tests"]

[tool.ruff]
# Exclude a variety of commonly ignored directories.
exclude = [
    ".bzr",
    ".direnv",
    ".eggs",
    ".git",
    ".hg",
    ".mypy_cache",
    ".nox",
    ".pants.d",
    ".pytype",
    ".ruff_cache",
    ".svn",
    ".tox",
    ".venv",
    "__pypackages__",
    "_build",
    "buck-out",
    "build",
    "dist",
    "node_modules",
    "venv",
]

line-length = 120

# this should be set to the oldest version of Python the package supports
target-version = "py310"

[tool.ruff.lint]
select = [
    # flake8-bugbear
    "B",
    # pydocstyle
    "D",
    # pycodestyle (errors)
    "E",
    # isort
    "I",
    # pyflakes
    "F",
    # pep8-naming
    "N",
    # pyupgrade
    "UP",
    # pycodestyle (warnings)
    "W",
]
fixable = ["ALL"]

ignore = [
    # (pydocstyle) Missing docstring in public class
    "D101",
    # (pydocstyle) Multi-line docstring summary should start at the first line
    "D212",
]

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.ruff.lint.per-file-ignores]
"rapids_cli/tests/*" = [
    # pydocstyle
    "D",
]
"docs/*" = [
    # pydocstyle
    "D",
]

[tool.mypy]
exclude = ["examples", "venv", "ci", "docs", "conftest.py"]
ignore_missing_imports = true
